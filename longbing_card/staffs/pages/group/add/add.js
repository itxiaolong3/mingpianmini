var _xx_util=require("../../../../resource/js/xx_util.js"),_xx_util2=_interopRequireDefault(_xx_util),_index=require("../../../../resource/apis/index.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var app=getApp();Page({data:{dataList:{page:1,total_page:1,list:[],refresh:!1,loading:!0},tagType:[]},onLoad:function(t){var a=this;wx.hideShareMenu(),a.setData({globalData:app.globalData,"dataList.refresh":!1},function(){a.toGetLabelList()})},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){var t=this;t.setData({"dataList.page":1,"dataList.refresh":!0},function(){wx.showNavigationBarLoading(),t.toGetLabelList()})},onReachBottom:function(){},onPageScroll:function(t){},onShareAppMessage:function(t){},toSearchCardBlur:function(){this.setData({toSearchCard:!1})},toSearchCard:function(t){var a=t.detail.value;this.setData({cardSearchKey:a})},toSearchCardConfirm:function(){var t=this;t.setData({refreshCardList:!0},function(){t.toGetLabelList()})},toGetLabelList:function(){var e=this,t=e.data,a=t.cardSearchKey,i=t.dataList,o=t.tagType,n={};a&&(n.keyword=a),i.refresh||_xx_util2.default.showLoading(),_index.staffModel.getLabelList(n).then(function(t){for(var a in _xx_util2.default.hideAll(),console.log("getLabelList ==>",t.data),i.list=t.data,i.refresh=!1,i.loading=!1,i.page=1,i.total_page=1,i.list)o.push(0);e.setData({dataList:i,tagType:o})})},toJump:function(t){var a=this,e=_xx_util2.default.getData(t),i=e.status,o=e.type,n=e.index;if("toSearchCardFocus"==i)a.setData({toSearchCard:!0});else if("toJumpUrl"==i){if("toSend"==o)if(!a.data.check_lable_count)return wx.showModal({title:"",content:"请选择将要进行群发的标签组！",success:function(t){t.confirm}}),!1;_xx_util2.default.goUrl(t)}else if("toCheckTag"==i){var r=a.data,s=r.tagType,l=r.dataList,u=0;0==o&&(u=1),s[n]=u;var c=0,d="",f="";for(var h in s)1==s[h]&&(c+=s[h],d+=l.list[h].lable_id+",",f+=l.list[h].name+"("+l.list[h].count+")，");d=d.slice(0,-1),f=f.slice(0,-1),a.setData({tagType:s,check_lable_count:c,check_lable_id:d,check_lable_name:f})}}}); 
