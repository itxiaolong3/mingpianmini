var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},app=getApp();Page({data:{setCount:[{name:"男"},{name:"女"}],count:-1,date:"",clientData:[]},onLoad:function(t){var a=this;console.log(t,"options为页面跳转所带来的参数"),app.util.showLoading(1),wx.hideShareMenu();var e={};t.id&&(e.id=t.id),t.fromstatus&&(e.fromstatus=t.fromstatus),t.staff_id&&(e.staff_id=t.staff_id),a.setData({param:e,globalData:app.globalData},function(){a.shuaxin(),wx.hideLoading()})},onReady:function(){},onShow:function(t){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){var t=this;wx.showNavigationBarLoading(),t.setData({showClientSource:!1},function(){t.shuaxin(1)})},onReachBottom:function(){},onPageScroll:function(t){},onShareAppMessage:function(t){},shuaxin:function(r){var u=this,t={client_id:u.data.param.id},a=u.data.param;a.staff_id&&(t.staff_id=a.staff_id),app.util.request({url:"entry/wxapp/clientInfo",cachetime:"30",method:"POST",data:t,success:function(t){if(console.log("clientInfo ==>",t),!t.data.errno){var a=t.data.data;for(var e in a.info)"undefined"!=a.info[e]&&null!=_typeof(a.info[e])||(a.info[e]="");var o=a.info.sex;o||(o="-1");var n=a.share_str,i={};if(-1<n.indexOf("//XL:")){var s=n.split("//XL:");i.clientSourceStr=s,i.clientSourceType="group"}u.setData({clientData:a,count:o,showClientSourceData:i,date:a.info.birthday}),r&&wx.stopPullDownRefresh()}}})},listenerDatePickerSelected:function(t){var a=t.detail.value;this.setData({date:a})},pickerSelected:function(t){var a=t.detail.value;a&&this.setData({count:a,"froms.sex":a})},blur_name:function(t){var a=t.detail.value;a&&this.setData({"froms.name":a})},switchChange:function(t){if(this.data.param.fromstatus)return!1;t.detail.value&&this.setData({"froms.is_mask":t.detail.value})},toEditInfo:function(t){app.util.request({url:"entry/wxapp/editClient",cachetime:"30",method:"POST",data:t,success:function(t){t.data.errno||wx.showToast({icon:"none",title:"客户信息修改成功！",duration:2e3,success:function(){setTimeout(function(){wx.navigateBack()},2e3)}})},fail:function(t){}})},toJump:function(t){var a=t.currentTarget.dataset.status;"toSource"==a?this.setData({showClientSource:!0}):"toClose"==a&&this.setData({showClientSource:!1})},formSubmit:function(t){var a=this,e=t.detail.formId,o=t.detail.target.dataset.status;if(a.toSaveFormIds(e),"toEditStaff"==o){var n=t.detail.value;n.client_id=a.data.param.id;var i=a.data.count;for(var s in"-1"!=i&&"undefined"!=i||(i=""),n.sex=i,n.birthday=a.data.date,n)"undefined"==n[s]&&(n[s]="");0==n.is_mask?n.is_mask=0:n.is_mask=1,a.toEditInfo(n)}},toSaveFormIds:function(t){app.util.request({url:"entry/wxapp/formid",cachetime:"30",method:"POST",data:{formId:t},success:function(t){t.data.errno},fail:function(t){}})}}); 
