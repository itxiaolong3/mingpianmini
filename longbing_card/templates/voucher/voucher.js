var _that=void 0,_userModel=void 0,_util=void 0;function getVoucher(t,e,a,o){if(_that=t,_userModel=e,_util=a,"getPhoneNumber:ok"==o.detail.errMsg){var u=o.detail.encryptedData,h=o.detail.iv;if(console.log(u,h),t.setPhoneInfo(u,h),_that.data.cardIndexData.coupon.id){var r={to_uid:_that.data.paramData.to_uid,coupon_id:_that.data.cardIndexData.coupon.id};_userModel.getCoupon(r).then(function(t){_util.hideAll(),_that.setData({"voucherStatus.status":"receive"},function(){toShareVoucher()})})}}else o.detail.errMsg}function setPhoneInfo(t,e){var a={encryptedData:t,iv:e,to_uid:getApp().globalData.to_uid};_baseModel.getPhone(a).then(function(t){if(util.hideAll(),t.data){var e=wx.getStorageSync("userid"),a=wx.getStorageSync("user");a.phone=t.data.phone,wx.setStorageSync("userid",e),wx.setStorageSync("user",a)}getApp().globalData.hasClientPhone=!0,getApp().globalData.auth.authPhoneStatus=!0,_that.setData({"globalData.hasClientPhone":!0,"globalData.auth.authPhoneStatus":!0})})}function toGetCoupon(t,e,a){_userModel=e,_util=a;var o={to_uid:(_that=t).data.paramData.to_uid,coupon_id:_that.data.cardIndexData.coupon.id};_userModel.getCoupon(o).then(function(t){_util.hideAll(),_that.setData({"voucherStatus.status":"receive"},function(){toShareVoucher()})})}function toShareVoucher(t){_that=t,wx.navigateTo({url:"/longbing_card/pages/voucher/voucher"})}function toBigVoucher(t){(_that=t).setData({"voucherStatus.show":!0})}function toCloseVoucher(t){"voulist"==(_that=t).data.currPage?_that.setData({"voucherStatus.show":!1}):_that.setData({"voucherStatus.show":-1},setTimeout(function(){_that.setData({"voucherStatus.show":!1})},500))}module.exports={getVoucher:getVoucher,toGetCoupon:toGetCoupon,toBigVoucher:toBigVoucher,toShareVoucher:toShareVoucher,toCloseVoucher:toCloseVoucher};