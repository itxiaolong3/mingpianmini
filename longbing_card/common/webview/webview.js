var _xx_util=require("../../resource/js/xx_util.js"),_xx_util2=_interopRequireDefault(_xx_util),_index=require("../../resource/apis/index.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var app=getApp();Page({data:{src:""},onLoad:function(t){var e=this;console.log(t,"options webview");var a=this;wx.hideShareMenu();var o=decodeURIComponent(t.url),i={};t.to_uid&&(i.to_uid=t.to_uid),t.from_id&&(i.from_id=t.from_id),t.id&&(i.id=t.id),t.fromshare&&(i.fromshare=t.fromshare),t.report_id&&(i.report_id=t.report_id),t.shareimg&&(i.shareimg=t.shareimg),t.status&&(i.status=t.status,"toNewsLine"!=t.status&&"newsLine"!=t.status||wx.showShareMenu()),t.url&&(i.url=t.url),t.name&&(i.name=t.name,wx.setNavigationBarTitle({title:t.name})),getApp().getConfigInfo(!0,!1).then(function(){e.setData({paramObj:i,src:o,globalData:app.globalData},function(){if("toNewsLine"==a.data.paramObj.status||"newsLine"==a.data.paramObj.status){var t=a.data.paramObj,e={to_uid:t.to_uid,sign:"view",type:9,target:t.report_id,scene:app.globalData.loginParam.scene,uniacid:app.siteInfo.uniacid};app.globalData.to_uid!=wx.getStorageSync("userid")&&(a.toGetReport(e),getApp().getCardAfter()),a.getDetailData()}})})},onReady:function(){},onShow:function(){},onHide:function(){"toNewsLine"==this.data.paramObj.status&&this.goToHome()},onUnload:function(){"toNewsLine"==this.data.paramObj.status&&this.goToHome()},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){var t=this.data.paramObj,e=t.status,a=t.to_uid,o=t.from_id,i=t.url,n=t.name,r=t.report_id,s=t.shareimg,u=t.id,d=this.data.tmpData;if(n=d.title,i=encodeURIComponent(d.content),s=encodeURIComponent(d.cover[0]),"toNewsLine"==e||"newsLine"==e)return{title:n,path:"/longbing_card/common/transtion/transtion?id="+u+"&to_uid="+a+"&from_id="+o+"&status=toNewsLine&url="+i+"&name="+n+"&report_id="+r+"&fromshare=true&shareimg="+s,imageUrl:decodeURIComponent(s)}},toGetReport:function(t){_index.baseModel.getReport(t).then(function(t){_xx_util2.default.hideAll()})},getDetailData:function(){var s=this,t=s.data.paramObj,e={id:t.id,to_uid:t.to_uid};_index.userModel.getTimeLineDetail(e).then(function(t){var e=t.data;if(s.setData({tmpData:e}),-2==t.errno){var a=s.data.paramObj,o=a.fromshare,i=a.to_uid,n=a.from_id;n||(n=wx.getStorageSync("userid"));var r="确定";"true"==o&&(r="返回首页"),wx.showModal({title:"提示",content:t.message,confirmText:r,showCancel:!1,success:function(t){t.confirm&&"true"==o&&wx.reLaunch({url:"/longbing_card/pages/index/index?to_uid="+i+"&from_id="+n+"&currentTabBar=toNews"})}})}})},goToHome:function(){var t=this.data.paramObj,e=t.to_uid,a=t.from_id,o=(t.type,"/longbing_card/pages/index/index?to_uid="+e+"&from_id="+a+"&currentTabBar=toCard");wx.reLaunch({url:o})}}); 
