var _xx_util=require("../../../../resource/js/xx_util.js"),_xx_util2=_interopRequireDefault(_xx_util),_index=require("../../../../resource/apis/index.js");function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var app=getApp(),getAppGlobalData=require("../../../../templates/copyright/copyright.js");Page({data:{globalData:{},refresh:!1},onLoad:function(a){console.log(a,"options");var t=this,e={};a.id&&(e.id=a.id),a.type&&(e.type=a.type),a.name&&(e.name=a.name,wx.setNavigationBarTitle({title:a.name})),a.status&&(e.status=a.status),a.fromshare&&(e.fromshare=a.fromshare),a.src&&(e.src=a.src),a.report_id&&(e.report_id=a.report_id),a.shareimg&&(e.shareimg=a.shareimg,e.cover=decodeURIComponent(a.shareimg)),a.table_name&&(e.table_name=a.table_name),a.to_uid&&(e.to_uid=a.to_uid,app.globalData.to_uid=a.to_uid),a.from_id&&(e.from_id=a.from_id,app.globalData.from_id=a.from_id),console.log(e,"paramData"),getApp().getConfigInfo(!0,!1).then(function(){t.setData({paramData:e,globalData:app.globalData},function(){("toPlayVideo"!=e.status||e.table_name)&&(_xx_util2.default.showLoading(),t.getModularInfo())})}),wx.hideLoading()},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){var a=this;getApp().getConfigInfo(!0,!1).then(function(){a.setData({globalData:app.globalData,refresh:!0},function(){wx.showNavigationBarLoading(),a.getModularInfo()})})},onReachBottom:function(){},onShareAppMessage:function(a){"button"===a.from?console.log("来自页面内转发按钮"):console.log("来自右上角转发菜单");var t=this.data.paramData,e=t.status,o=t.to_uid,r=t.name,i=t.title,n=t.src,d=t.shareimg,l=t.id,u=t.type,s=t.table_name,g=void 0;if(g=2==u||"toPlayVideo"==e?r:i,o||(o=app.globalData.to_uid),"toPlayVideo"==e){var m="/longbing_card/users/pages/company/detail/detail?to_uid="+o+"&from_id="+wx.getStorageSync("userid")+"&status=toPlayVideo&name="+r+"&fromshare=true&shareimg=";if("toPlayVideo"==e&&s){var p=this.data.detailData,c=p.cover,f=p.video;(c||f)&&(d=encodeURIComponent(c),n=encodeURIComponent(f),m=m+d+"&table_name="+s+"&id="+l)}else m+=d;return m=m+"&src="+n,console.log(m,"tmp_path"),{title:g,path:m,imageUrl:decodeURIComponent(d)}}var _="/longbing_card/users/pages/company/detail/detail?to_uid="+o+"&from_id="+wx.getStorageSync("userid")+"&id="+l+"&type="+u+"&name="+r+"&fromshare=true&table_name="+s;return console.log(_,"tmp_path"),{title:g,path:_,imageUrl:""}},getModularInfo:function(){var l=this,a=l.data,t=l.data.paramData,e=t.id,o=t.table_name;a||_xx_util2.default.showLoading();var r={id:e,table_name:o};_index.userModel.getModularInfo(r).then(function(a){_xx_util2.default.hideAll(),console.log("getModularInfo ==>",a.data);var t=a.data,e=new app.util.date;if(t.create_time=e.dateToStr("MM月DD日",e.longToDate(1e3*t.create_time)),l.setData({detailData:t}),-2==a.errno){var o=l.data.paramData,r=o.fromshare,i=o.to_uid,n=o.from_id;n||(n=wx.getStorageSync("userid"));var d="确定";"true"==r&&(d="返回首页"),wx.showModal({title:"提示",content:a.message,confirmText:d,showCancel:!1,success:function(a){a.confirm&&"true"==r&&wx.reLaunch({url:"/longbing_card/pages/index/index?to_uid="+i+"&from_id="+n+"&currentTabBar=toCompany"})}})}})},toJump:function(a){var t=a.currentTarget.dataset.status,e=a.currentTarget.dataset.content;if("toCopyright"==t&&app.util.goUrl(a),"toCall"==t){if(console.log("联系HR"),!e)return!1;wx.makePhoneCall({phoneNumber:e})}},formSubmit:function(a){var t=a.detail.formId,e=(a.detail.target.dataset.index,a.detail.target.dataset.status);this.toSaveFormIds(t),"toHome"==e&&wx.reLaunch({url:"/longbing_card/pages/index/index?to_uid="+app.globalData.to_uid+"&from_id="+app.globalData.from_id+"&currentTabBar=toCard"})},toSaveFormIds:function(a){var t={formId:a};_index.baseModel.getFormId(t).then(function(a){_xx_util2.default.hideAll()})}}); 
