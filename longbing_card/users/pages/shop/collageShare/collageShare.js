var _xx_util=require("../../../../resource/js/xx_util.js"),_xx_util2=_interopRequireDefault(_xx_util),_index=require("../../../../resource/apis/index.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var app=getApp();Page({imagePath:"",data:{template:{}},onLoad:function(t){var e,o=this;wx.hideShareMenu(),setTimeout(function(){app.util.showLoading(4)},300),getApp().getConfigInfo().then(function(){o.setData({globalData:app.globalData},function(){20<(e=o.data.globalData.configInfo.my_company.name).length&&o.data.globalData.configInfo.my_company.short_name&&(e=o.data.globalData.configInfo.my_company.short_name)})});var r=getCurrentPages(),a=r[r.length-2].__viewData__;console.log("prevPage",a);var n=a.shareParamObj;18<n.name.length&&(n.name=n.name.substr(0,18)+"...");var i,p=a.shareParamObj2,l=(p.price/1e4).toFixed(2);1<l||1==l?(p.price=l+"万",i=22*parseInt(p.price.length)+20):0==p.price&&(i=22*parseInt(p.price.length),p.price=app.globalData.configInfo.config.btn_talk||"面议"),0==p.price&&(p.price=app.globalData.configInfo.config.btn_talk||"面议");var x=22*parseInt(p.people.length),c=i+"rpx",s=parseInt(i+45)+"rpx",f=parseInt(x+70)+"rpx",g=app.globalData.isIphoneX;wx.hideShareMenu(),setTimeout(function(){var t={width:"612rpx",height:"987rpx",background:"#e1e1e1",views:[{type:"image",url:"/longbing_card/resource/images/icon-productBg.png",css:{top:"0rpx",left:"0rpx",width:"612rpx",height:"82rpx",rotate:0,borderRadius:0}},{type:"text",text:e,css:{fontSize:"28rpx",top:"10rpx",left:"306rpx",color:"#ffffff",bold:"bold",textDecoration:"none",align:"center",width:"572rpx"}},{type:"rect",css:{top:"82rpx",left:"0rpx",color:"#ffffff",borderRadius:"0rpx",width:"612rpx",height:"97rpx"}},{type:"text",text:n.name,css:{fontSize:"30rpx",top:"78rpx",left:"20rpx",color:"#313131",bold:"bold",textDecoration:"none",align:"left",width:"572rpx"}},{type:"text",text:"￥",css:{fontSize:"24rpx",top:"130rpx",left:"20rpx",color:"#e93636",bold:"bold",textDecoration:"none",align:"left",width:"20rpx"}},{type:"text",text:p.price,css:{fontSize:"36rpx",top:"120rpx",left:"48rpx",color:"#e93636",bold:"bold",textDecoration:"none",align:"left",width:c}},{type:"text",text:p.people+"人拼团",css:{fontSize:"24rpx",top:"130rpx",left:s,color:"#e93636",bold:"bold",textDecoration:"none",align:"left",width:f}},{type:"text",text:"已拼"+n.collage_count,css:{fontSize:"24rpx",top:"130rpx",right:"20rpx",color:"#313131",bold:"bold",textDecoration:"none",align:"right",width:"680rpx"}},{type:"image",url:n.cover2,css:{top:"187rpx",left:"9rpx",width:"594rpx",height:"594rpx",rotate:0,borderRadius:0}},{type:"rect",css:{top:"786rpx",left:"2rpx",color:"#ffffff",borderRadius:"5rpx",width:"612rpx",height:"200rpx"}},{type:"image",url:n.qr,css:{top:"808rpx",left:"78rpx",width:"158rpx",height:"158rpx",rotate:0,borderRadius:0}},{type:"text",text:"长按识别小程序码",css:{fontSize:"30rpx",top:"850rpx",left:"300rpx",color:"#313131",bold:"bold",textDecoration:"none",align:"left",width:"300rpx"}},{type:"text",text:"超值好货一起拼",css:{fontSize:"24rpx",top:"900rpx",left:"300rpx",color:"#313131",bold:"bold",textDecoration:"none",align:"left",width:"300rpx"}}]};o.setData({template:t,isIphoneX:g})},3e3)},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(t){},onImgOK:function(t){this.setData({imagePath:t.detail.path}),wx.hideLoading(),console.log(t)},previewImage:function(){var t=this.data.imagePath,e=[];e.push(t),wx.previewImage({current:t,urls:e})},saveImage:function(){var o=this;wx.authorize({scope:"scope.writePhotosAlbum",success:function(t){wx.saveImageToPhotosAlbum({filePath:o.data.imagePath,success:function(t){console.log("保存海报成功 ==>",t),wx.showToast({icon:"none",title:"海报保存成功，快去相册看看吧！",duration:2e3})},fail:function(t){console.log("fail ==> ",t)}})},fail:function(t){var e=t.errMsg;(-1<e.indexOf("fail auth deny")||-1<e.indexOf("fail:auth deny"))&&o.setData({isSetting:!0})}})}}); 
